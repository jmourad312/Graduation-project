{"ast":null,"code":"import { __rest, __assign, __spreadArrays } from 'tslib';\nimport { invariant } from 'hey-listen';\n\nvar getPoseValues = function (_a) {\n  var transition = _a.transition,\n      flip = _a.flip,\n      delay = _a.delay,\n      delayChildren = _a.delayChildren,\n      staggerChildren = _a.staggerChildren,\n      staggerDirection = _a.staggerDirection,\n      afterChildren = _a.afterChildren,\n      beforeChildren = _a.beforeChildren,\n      preTransition = _a.preTransition,\n      applyAtStart = _a.applyAtStart,\n      applyAtEnd = _a.applyAtEnd,\n      props = __rest(_a, [\"transition\", \"flip\", \"delay\", \"delayChildren\", \"staggerChildren\", \"staggerDirection\", \"afterChildren\", \"beforeChildren\", \"preTransition\", \"applyAtStart\", \"applyAtEnd\"]);\n\n  return props;\n};\n\nvar selectPoses = function (_a) {\n  var label = _a.label,\n      props = _a.props,\n      values = _a.values,\n      parentValues = _a.parentValues,\n      ancestorValues = _a.ancestorValues,\n      onChange = _a.onChange,\n      passive = _a.passive,\n      initialPose = _a.initialPose,\n      poses = __rest(_a, [\"label\", \"props\", \"values\", \"parentValues\", \"ancestorValues\", \"onChange\", \"passive\", \"initialPose\"]);\n\n  return poses;\n};\n\nvar selectAllValues = function (values, selectValue) {\n  var allValues = {};\n  values.forEach(function (value, key) {\n    return allValues[key] = selectValue(value);\n  });\n  return allValues;\n};\n\nvar resolveProp = function (target, props) {\n  return typeof target === 'function' ? target(props) : target;\n};\n\nvar poseDefault = function (pose, prop, defaultValue, resolveProps) {\n  return pose && pose[prop] !== undefined ? resolveProp(pose[prop], resolveProps) : defaultValue;\n};\n\nvar startChildAnimations = function (children, next, pose, props) {\n  var animations = [];\n  var delay = poseDefault(pose, 'delayChildren', 0, props);\n  var stagger = poseDefault(pose, 'staggerChildren', 0, props);\n  var staggerDirection = poseDefault(pose, 'staggerDirection', 1, props);\n  var maxStaggerDuration = (children.size - 1) * stagger;\n  var generateStaggerDuration = staggerDirection === 1 ? function (i) {\n    return i * stagger;\n  } : function (i) {\n    return maxStaggerDuration - i * stagger;\n  };\n  Array.from(children).forEach(function (child, i) {\n    animations.push(child.set(next, {\n      delay: delay + generateStaggerDuration(i)\n    }));\n  });\n  return animations;\n};\n\nvar resolveTransition = function (transition, key, value, props, convertTransitionDefinition, getInstantTransition) {\n  var resolvedTransition;\n\n  if (typeof transition === 'function') {\n    var resolvedTransitionMap = transition(props);\n    resolvedTransition = resolveTransition(resolvedTransitionMap, key, value, props, convertTransitionDefinition, getInstantTransition);\n  } else if (transition[key] || transition.default) {\n    var keyTransition = transition[key] || transition.default;\n\n    if (typeof keyTransition === 'function') {\n      resolvedTransition = keyTransition(props);\n    } else {\n      resolvedTransition = keyTransition;\n    }\n  } else {\n    resolvedTransition = transition;\n  }\n\n  return resolvedTransition === false ? getInstantTransition(value, props) : convertTransitionDefinition(value, resolvedTransition, props);\n};\n\nvar findInsertionIndex = function (poseList, priorityList, priorityIndex) {\n  var insertionIndex = 0;\n\n  for (var i = priorityIndex - 1; i >= 0; i--) {\n    var nextHighestPriorityIndex = poseList.indexOf(priorityList[i]);\n\n    if (nextHighestPriorityIndex !== -1) {\n      insertionIndex = nextHighestPriorityIndex + 1;\n      break;\n    }\n  }\n\n  return insertionIndex;\n};\n\nvar applyValues = function (toApply, values, props, setValue, setValueNative) {\n  invariant(typeof toApply === 'object', 'applyAtStart and applyAtEnd must be of type object');\n  return Object.keys(toApply).forEach(function (key) {\n    var valueToSet = resolveProp(toApply[key], props);\n    values.has(key) ? setValue(values.get(key), valueToSet) : setValueNative(key, valueToSet, props);\n  });\n};\n\nvar createPoseSetter = function (setterProps) {\n  var state = setterProps.state,\n      poses = setterProps.poses,\n      startAction = setterProps.startAction,\n      stopAction = setterProps.stopAction,\n      getInstantTransition = setterProps.getInstantTransition,\n      addActionDelay = setterProps.addActionDelay,\n      getTransitionProps = setterProps.getTransitionProps,\n      resolveTarget = setterProps.resolveTarget,\n      transformPose = setterProps.transformPose,\n      posePriority = setterProps.posePriority,\n      convertTransitionDefinition = setterProps.convertTransitionDefinition,\n      setValue = setterProps.setValue,\n      setValueNative = setterProps.setValueNative,\n      forceRender = setterProps.forceRender;\n  return function (next, nextProps, propagate) {\n    if (nextProps === void 0) {\n      nextProps = {};\n    }\n\n    if (propagate === void 0) {\n      propagate = true;\n    }\n\n    var children = state.children,\n        values = state.values,\n        props = state.props,\n        activeActions = state.activeActions,\n        activePoses = state.activePoses;\n    var _a = nextProps.delay,\n        delay = _a === void 0 ? 0 : _a;\n    var hasChildren = children.size;\n\n    var baseTransitionProps = __assign(__assign({}, props), nextProps);\n\n    var nextPose = poses[next];\n\n    var getChildAnimations = function () {\n      return hasChildren && propagate ? startChildAnimations(children, next, nextPose, baseTransitionProps) : [];\n    };\n\n    var getParentAnimations = function () {\n      if (!nextPose) return [];\n      var applyAtStart = nextPose.applyAtStart;\n\n      if (applyAtStart) {\n        applyValues(applyAtStart, values, baseTransitionProps, setValue, setValueNative);\n        if (forceRender) forceRender(baseTransitionProps);\n      }\n\n      if (transformPose) nextPose = transformPose(nextPose, next, state);\n      var preTransition = nextPose.preTransition,\n          getTransition = nextPose.transition,\n          applyAtEnd = nextPose.applyAtEnd;\n      if (preTransition) preTransition(baseTransitionProps);\n      var animations = Object.keys(getPoseValues(nextPose)).map(function (key) {\n        var valuePoses = activePoses.has(key) ? activePoses.get(key) : (activePoses.set(key, []), activePoses.get(key));\n        var existingIndex = valuePoses.indexOf(next);\n        if (existingIndex !== -1) valuePoses.splice(existingIndex, 1);\n        var priority = posePriority ? posePriority.indexOf(next) : 0;\n        var insertionIndex = priority <= 0 ? 0 : findInsertionIndex(valuePoses, posePriority, priority);\n        valuePoses.splice(insertionIndex, 0, next);\n        return insertionIndex === 0 ? new Promise(function (complete) {\n          var value = values.get(key);\n\n          var transitionProps = __assign(__assign({}, baseTransitionProps), {\n            key: key,\n            value: value\n          });\n\n          var target = resolveTarget(value, resolveProp(nextPose[key], transitionProps));\n          if (activeActions.has(key)) stopAction(activeActions.get(key));\n\n          var resolveTransitionProps = __assign(__assign({\n            to: target\n          }, transitionProps), getTransitionProps(value, target, transitionProps));\n\n          var transition = resolveTransition(getTransition, key, value, resolveTransitionProps, convertTransitionDefinition, getInstantTransition);\n          var poseDelay = delay || resolveProp(nextPose.delay, transitionProps);\n\n          if (poseDelay) {\n            transition = addActionDelay(poseDelay, transition);\n          }\n\n          activeActions.set(key, startAction(value, transition, complete));\n        }) : Promise.resolve();\n      });\n      return applyAtEnd ? [Promise.all(animations).then(function () {\n        applyValues(applyAtEnd, values, baseTransitionProps, setValue, setValueNative);\n      })] : animations;\n    };\n\n    if (nextPose && hasChildren) {\n      if (resolveProp(nextPose.beforeChildren, baseTransitionProps)) {\n        return Promise.all(getParentAnimations()).then(function () {\n          return Promise.all(getChildAnimations());\n        });\n      } else if (resolveProp(nextPose.afterChildren, baseTransitionProps)) {\n        return Promise.all(getChildAnimations()).then(function () {\n          return Promise.all(getParentAnimations());\n        });\n      }\n    }\n\n    return Promise.all(__spreadArrays(getParentAnimations(), getChildAnimations()));\n  };\n};\n\nvar DEFAULT_INITIAL_POSE = 'init';\n\nvar isScale = function (key) {\n  return key.includes('scale');\n};\n\nvar defaultReadValueFromSource = function (key) {\n  return isScale(key) ? 1 : 0;\n};\n\nvar readValueFromPose = function (pose, key, props) {\n  var valueToResolve = pose.applyAtEnd && pose.applyAtEnd[key] !== undefined ? pose.applyAtEnd[key] : pose[key] !== undefined ? pose[key] : pose.applyAtStart && pose.applyAtStart[key] !== undefined ? pose.applyAtStart[key] : 0;\n  return resolveProp(valueToResolve, props);\n};\n\nvar getPosesToSearch = function (pose) {\n  var posesToSearch = Array.isArray(pose) ? pose : [pose];\n  posesToSearch.push(DEFAULT_INITIAL_POSE);\n  return posesToSearch;\n};\n\nvar getInitialValue = function (poses, key, initialPose, props, readValueFromSource, activePoses) {\n  if (readValueFromSource === void 0) {\n    readValueFromSource = defaultReadValueFromSource;\n  }\n\n  var posesToSearch = getPosesToSearch(initialPose);\n  var pose = posesToSearch.filter(Boolean).find(function (name) {\n    var thisPose = poses[name];\n    return thisPose && (thisPose[key] !== undefined || thisPose.applyAtStart && thisPose.applyAtStart[key] !== undefined || thisPose.applyAtEnd && thisPose.applyAtEnd[key] !== undefined);\n  });\n  activePoses.set(key, [pose || DEFAULT_INITIAL_POSE]);\n  return pose ? readValueFromPose(poses[pose], key, props) : readValueFromSource(key, props);\n};\n\nvar createValues = function (values, _a) {\n  var userSetValues = _a.userSetValues,\n      createValue = _a.createValue,\n      convertValue = _a.convertValue,\n      readValueFromSource = _a.readValueFromSource,\n      initialPose = _a.initialPose,\n      poses = _a.poses,\n      activePoses = _a.activePoses,\n      props = _a.props;\n  return function (key) {\n    if (values.has(key)) return;\n    var value;\n\n    if (userSetValues && userSetValues[key] !== undefined) {\n      value = convertValue(userSetValues[key], key, props);\n    } else {\n      var initValue = getInitialValue(poses, key, initialPose, props, readValueFromSource, activePoses);\n      value = createValue(initValue, key, props);\n    }\n\n    values.set(key, value);\n  };\n};\n\nvar scrapeValuesFromPose = function (values, props) {\n  return function (key) {\n    var pose = props.poses[key];\n    Object.keys(getPoseValues(pose)).forEach(createValues(values, props));\n  };\n};\n\nvar getAncestorValue = function (key, fromParent, ancestors) {\n  if (fromParent === true) {\n    return ancestors[0] && ancestors[0].values.get(key);\n  } else {\n    var foundAncestor = ancestors.find(function (_a) {\n      var label = _a.label;\n      return label === fromParent;\n    });\n    return foundAncestor && foundAncestor.values.get(key);\n  }\n};\n\nvar bindPassiveValues = function (values, _a) {\n  var passive = _a.passive,\n      ancestorValues = _a.ancestorValues,\n      createValue = _a.createValue,\n      readValue = _a.readValue,\n      props = _a.props;\n  return function (key) {\n    var _a = passive[key],\n        valueKey = _a[0],\n        passiveProps = _a[1],\n        fromParent = _a[2];\n    var valueToBind = fromParent && ancestorValues.length ? getAncestorValue(valueKey, fromParent, ancestorValues) : values.has(valueKey) ? values.get(valueKey) : false;\n    if (!valueToBind) return;\n    var newValue = createValue(readValue(valueToBind), key, props, {\n      passiveParentKey: valueKey,\n      passiveParent: valueToBind,\n      passiveProps: passiveProps\n    });\n    values.set(key, newValue);\n  };\n};\n\nvar setNativeValues = function (_a) {\n  var setValueNative = _a.setValueNative,\n      initialPose = _a.initialPose,\n      props = _a.props,\n      poses = _a.poses;\n  var valuesHaveSet = new Set();\n\n  var setValues = function (pose, propKey) {\n    if (pose[propKey]) {\n      for (var key in pose[propKey]) {\n        if (!valuesHaveSet.has(key)) {\n          valuesHaveSet.add(key);\n          setValueNative(key, resolveProp(pose[propKey][key], props), props);\n        }\n      }\n    }\n  };\n\n  getPosesToSearch(initialPose).forEach(function (poseKey) {\n    var pose = poses[poseKey];\n\n    if (pose) {\n      setValues(pose, 'applyAtEnd');\n      setValues(pose, 'applyAtStart');\n    }\n  });\n};\n\nvar createValueMap = function (props) {\n  var poses = props.poses,\n      passive = props.passive;\n  var values = new Map();\n  Object.keys(poses).forEach(scrapeValuesFromPose(values, props));\n  setNativeValues(props);\n  if (passive) Object.keys(passive).forEach(bindPassiveValues(values, props));\n  return values;\n};\n\nvar applyDefaultTransition = function (pose, key, defaultTransitions) {\n  return __assign(__assign({}, pose), {\n    transition: defaultTransitions.has(key) ? defaultTransitions.get(key) : defaultTransitions.get('default')\n  });\n};\n\nvar generateTransitions = function (poses, defaultTransitions) {\n  Object.keys(poses).forEach(function (key) {\n    var pose = poses[key];\n    invariant(typeof pose === 'object', \"Pose '\" + key + \"' is of invalid type. All poses should be objects.\");\n    poses[key] = pose.transition !== undefined ? pose : applyDefaultTransition(pose, key, defaultTransitions);\n  });\n  return poses;\n};\n\nvar sortByReversePriority = function (priorityOrder) {\n  return function (a, b) {\n    var aP = priorityOrder.indexOf(a);\n    var bP = priorityOrder.indexOf(b);\n    if (aP === -1 && bP !== -1) return -1;\n    if (aP !== -1 && bP === -1) return 1;\n    return aP - bP;\n  };\n};\n\nvar poseFactory = function (_a) {\n  var getDefaultProps = _a.getDefaultProps,\n      defaultTransitions = _a.defaultTransitions,\n      bindOnChange = _a.bindOnChange,\n      startAction = _a.startAction,\n      stopAction = _a.stopAction,\n      readValue = _a.readValue,\n      readValueFromSource = _a.readValueFromSource,\n      resolveTarget = _a.resolveTarget,\n      setValue = _a.setValue,\n      setValueNative = _a.setValueNative,\n      createValue = _a.createValue,\n      convertValue = _a.convertValue,\n      getInstantTransition = _a.getInstantTransition,\n      getTransitionProps = _a.getTransitionProps,\n      addActionDelay = _a.addActionDelay,\n      selectValueToRead = _a.selectValueToRead,\n      convertTransitionDefinition = _a.convertTransitionDefinition,\n      transformPose = _a.transformPose,\n      posePriority = _a.posePriority,\n      forceRender = _a.forceRender,\n      extendAPI = _a.extendAPI;\n  return function (config) {\n    var parentValues = config.parentValues,\n        _a = config.ancestorValues,\n        ancestorValues = _a === void 0 ? [] : _a;\n    if (parentValues) ancestorValues.unshift({\n      values: parentValues\n    });\n    var activeActions = new Map();\n    var activePoses = new Map();\n    var children = new Set();\n    var poses = generateTransitions(selectPoses(config), defaultTransitions);\n    var _b = config.props,\n        props = _b === void 0 ? {} : _b;\n    if (getDefaultProps) props = __assign(__assign({}, getDefaultProps(config)), props);\n    var passive = config.passive,\n        userSetValues = config.values,\n        _c = config.initialPose,\n        initialPose = _c === void 0 ? DEFAULT_INITIAL_POSE : _c;\n    var values = createValueMap({\n      poses: poses,\n      passive: passive,\n      ancestorValues: ancestorValues,\n      readValue: readValue,\n      setValueNative: setValueNative,\n      createValue: createValue,\n      convertValue: convertValue,\n      readValueFromSource: readValueFromSource,\n      userSetValues: userSetValues,\n      initialPose: initialPose,\n      activePoses: activePoses,\n      props: props\n    });\n    var state = {\n      activeActions: activeActions,\n      activePoses: activePoses,\n      children: children,\n      props: props,\n      values: values\n    };\n    var onChange = config.onChange;\n    if (onChange) Object.keys(onChange).forEach(bindOnChange(values, onChange));\n    var set = createPoseSetter({\n      state: state,\n      poses: poses,\n      getInstantTransition: getInstantTransition,\n      getTransitionProps: getTransitionProps,\n      convertTransitionDefinition: convertTransitionDefinition,\n      setValue: setValue,\n      setValueNative: setValueNative,\n      startAction: startAction,\n      stopAction: stopAction,\n      resolveTarget: resolveTarget,\n      addActionDelay: addActionDelay,\n      transformPose: transformPose,\n      posePriority: posePriority,\n      forceRender: forceRender\n    });\n\n    var has = function (poseName) {\n      return !!poses[poseName];\n    };\n\n    var api = {\n      set: set,\n      unset: function (poseName, poseProps) {\n        var posesToSet = [];\n        activePoses.forEach(function (valuePoses) {\n          var poseIndex = valuePoses.indexOf(poseName);\n          if (poseIndex === -1) return;\n          var currentPose = valuePoses[0];\n          valuePoses.splice(poseIndex, 1);\n          var nextPose = valuePoses[0];\n          if (nextPose === currentPose) return;\n\n          if (posesToSet.indexOf(nextPose) === -1) {\n            posesToSet.push(nextPose);\n          }\n        });\n        var animationsToResolve = posesToSet.sort(sortByReversePriority(posePriority)).map(function (poseToSet) {\n          return set(poseToSet, poseProps, false);\n        });\n        children.forEach(function (child) {\n          return animationsToResolve.push(child.unset(poseName));\n        });\n        return Promise.all(animationsToResolve);\n      },\n      get: function (valueName) {\n        return valueName ? selectValueToRead(values.get(valueName)) : selectAllValues(values, selectValueToRead);\n      },\n      has: has,\n      setProps: function (newProps) {\n        return state.props = __assign(__assign({}, state.props), newProps);\n      },\n      _addChild: function (childConfig, factory) {\n        var child = factory(__assign(__assign({\n          initialPose: initialPose\n        }, childConfig), {\n          ancestorValues: __spreadArrays([{\n            label: config.label,\n            values: values\n          }], ancestorValues)\n        }));\n        children.add(child);\n        return child;\n      },\n      removeChild: function (child) {\n        return children.delete(child);\n      },\n      clearChildren: function () {\n        children.forEach(function (child) {\n          return child.destroy();\n        });\n        children.clear();\n      },\n      destroy: function () {\n        activeActions.forEach(stopAction);\n        children.forEach(function (child) {\n          return child.destroy();\n        });\n      }\n    };\n    return extendAPI(api, state, config);\n  };\n};\n\nexport default poseFactory;","map":{"version":3,"sources":["D:/J0E/Programming/ITI-Graduation-Project/CarReact/car-react/node_modules/pose-core/dist/pose-core.es.js"],"names":["__rest","__assign","__spreadArrays","invariant","getPoseValues","_a","transition","flip","delay","delayChildren","staggerChildren","staggerDirection","afterChildren","beforeChildren","preTransition","applyAtStart","applyAtEnd","props","selectPoses","label","values","parentValues","ancestorValues","onChange","passive","initialPose","poses","selectAllValues","selectValue","allValues","forEach","value","key","resolveProp","target","poseDefault","pose","prop","defaultValue","resolveProps","undefined","startChildAnimations","children","next","animations","stagger","maxStaggerDuration","size","generateStaggerDuration","i","Array","from","child","push","set","resolveTransition","convertTransitionDefinition","getInstantTransition","resolvedTransition","resolvedTransitionMap","default","keyTransition","findInsertionIndex","poseList","priorityList","priorityIndex","insertionIndex","nextHighestPriorityIndex","indexOf","applyValues","toApply","setValue","setValueNative","Object","keys","valueToSet","has","get","createPoseSetter","setterProps","state","startAction","stopAction","addActionDelay","getTransitionProps","resolveTarget","transformPose","posePriority","forceRender","nextProps","propagate","activeActions","activePoses","hasChildren","baseTransitionProps","nextPose","getChildAnimations","getParentAnimations","getTransition","map","valuePoses","existingIndex","splice","priority","Promise","complete","transitionProps","resolveTransitionProps","to","poseDelay","resolve","all","then","DEFAULT_INITIAL_POSE","isScale","includes","defaultReadValueFromSource","readValueFromPose","valueToResolve","getPosesToSearch","posesToSearch","isArray","getInitialValue","readValueFromSource","filter","Boolean","find","name","thisPose","createValues","userSetValues","createValue","convertValue","initValue","scrapeValuesFromPose","getAncestorValue","fromParent","ancestors","foundAncestor","bindPassiveValues","readValue","valueKey","passiveProps","valueToBind","length","newValue","passiveParentKey","passiveParent","setNativeValues","valuesHaveSet","Set","setValues","propKey","add","poseKey","createValueMap","Map","applyDefaultTransition","defaultTransitions","generateTransitions","sortByReversePriority","priorityOrder","a","b","aP","bP","poseFactory","getDefaultProps","bindOnChange","selectValueToRead","extendAPI","config","unshift","_b","_c","poseName","api","unset","poseProps","posesToSet","poseIndex","currentPose","animationsToResolve","sort","poseToSet","valueName","setProps","newProps","_addChild","childConfig","factory","removeChild","delete","clearChildren","destroy","clear"],"mappings":"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","sourcesContent":["import { __rest, __assign, __spreadArrays } from 'tslib';\nimport { invariant } from 'hey-listen';\n\nvar getPoseValues = function (_a) {\n    var transition = _a.transition,\n        flip = _a.flip,\n        delay = _a.delay,\n        delayChildren = _a.delayChildren,\n        staggerChildren = _a.staggerChildren,\n        staggerDirection = _a.staggerDirection,\n        afterChildren = _a.afterChildren,\n        beforeChildren = _a.beforeChildren,\n        preTransition = _a.preTransition,\n        applyAtStart = _a.applyAtStart,\n        applyAtEnd = _a.applyAtEnd,\n        props = __rest(_a, [\"transition\", \"flip\", \"delay\", \"delayChildren\", \"staggerChildren\", \"staggerDirection\", \"afterChildren\", \"beforeChildren\", \"preTransition\", \"applyAtStart\", \"applyAtEnd\"]);\n    return props;\n};\nvar selectPoses = function (_a) {\n    var label = _a.label,\n        props = _a.props,\n        values = _a.values,\n        parentValues = _a.parentValues,\n        ancestorValues = _a.ancestorValues,\n        onChange = _a.onChange,\n        passive = _a.passive,\n        initialPose = _a.initialPose,\n        poses = __rest(_a, [\"label\", \"props\", \"values\", \"parentValues\", \"ancestorValues\", \"onChange\", \"passive\", \"initialPose\"]);\n    return poses;\n};\nvar selectAllValues = function (values, selectValue) {\n    var allValues = {};\n    values.forEach(function (value, key) {\n        return allValues[key] = selectValue(value);\n    });\n    return allValues;\n};\n\nvar resolveProp = function (target, props) {\n    return typeof target === 'function' ? target(props) : target;\n};\nvar poseDefault = function (pose, prop, defaultValue, resolveProps) {\n    return pose && pose[prop] !== undefined ? resolveProp(pose[prop], resolveProps) : defaultValue;\n};\nvar startChildAnimations = function (children, next, pose, props) {\n    var animations = [];\n    var delay = poseDefault(pose, 'delayChildren', 0, props);\n    var stagger = poseDefault(pose, 'staggerChildren', 0, props);\n    var staggerDirection = poseDefault(pose, 'staggerDirection', 1, props);\n    var maxStaggerDuration = (children.size - 1) * stagger;\n    var generateStaggerDuration = staggerDirection === 1 ? function (i) {\n        return i * stagger;\n    } : function (i) {\n        return maxStaggerDuration - i * stagger;\n    };\n    Array.from(children).forEach(function (child, i) {\n        animations.push(child.set(next, {\n            delay: delay + generateStaggerDuration(i)\n        }));\n    });\n    return animations;\n};\nvar resolveTransition = function (transition, key, value, props, convertTransitionDefinition, getInstantTransition) {\n    var resolvedTransition;\n    if (typeof transition === 'function') {\n        var resolvedTransitionMap = transition(props);\n        resolvedTransition = resolveTransition(resolvedTransitionMap, key, value, props, convertTransitionDefinition, getInstantTransition);\n    } else if (transition[key] || transition.default) {\n        var keyTransition = transition[key] || transition.default;\n        if (typeof keyTransition === 'function') {\n            resolvedTransition = keyTransition(props);\n        } else {\n            resolvedTransition = keyTransition;\n        }\n    } else {\n        resolvedTransition = transition;\n    }\n    return resolvedTransition === false ? getInstantTransition(value, props) : convertTransitionDefinition(value, resolvedTransition, props);\n};\nvar findInsertionIndex = function (poseList, priorityList, priorityIndex) {\n    var insertionIndex = 0;\n    for (var i = priorityIndex - 1; i >= 0; i--) {\n        var nextHighestPriorityIndex = poseList.indexOf(priorityList[i]);\n        if (nextHighestPriorityIndex !== -1) {\n            insertionIndex = nextHighestPriorityIndex + 1;\n            break;\n        }\n    }\n    return insertionIndex;\n};\nvar applyValues = function (toApply, values, props, setValue, setValueNative) {\n    invariant(typeof toApply === 'object', 'applyAtStart and applyAtEnd must be of type object');\n    return Object.keys(toApply).forEach(function (key) {\n        var valueToSet = resolveProp(toApply[key], props);\n        values.has(key) ? setValue(values.get(key), valueToSet) : setValueNative(key, valueToSet, props);\n    });\n};\nvar createPoseSetter = function (setterProps) {\n    var state = setterProps.state,\n        poses = setterProps.poses,\n        startAction = setterProps.startAction,\n        stopAction = setterProps.stopAction,\n        getInstantTransition = setterProps.getInstantTransition,\n        addActionDelay = setterProps.addActionDelay,\n        getTransitionProps = setterProps.getTransitionProps,\n        resolveTarget = setterProps.resolveTarget,\n        transformPose = setterProps.transformPose,\n        posePriority = setterProps.posePriority,\n        convertTransitionDefinition = setterProps.convertTransitionDefinition,\n        setValue = setterProps.setValue,\n        setValueNative = setterProps.setValueNative,\n        forceRender = setterProps.forceRender;\n    return function (next, nextProps, propagate) {\n        if (nextProps === void 0) {\n            nextProps = {};\n        }\n        if (propagate === void 0) {\n            propagate = true;\n        }\n        var children = state.children,\n            values = state.values,\n            props = state.props,\n            activeActions = state.activeActions,\n            activePoses = state.activePoses;\n        var _a = nextProps.delay,\n            delay = _a === void 0 ? 0 : _a;\n        var hasChildren = children.size;\n        var baseTransitionProps = __assign(__assign({}, props), nextProps);\n        var nextPose = poses[next];\n        var getChildAnimations = function () {\n            return hasChildren && propagate ? startChildAnimations(children, next, nextPose, baseTransitionProps) : [];\n        };\n        var getParentAnimations = function () {\n            if (!nextPose) return [];\n            var applyAtStart = nextPose.applyAtStart;\n            if (applyAtStart) {\n                applyValues(applyAtStart, values, baseTransitionProps, setValue, setValueNative);\n                if (forceRender) forceRender(baseTransitionProps);\n            }\n            if (transformPose) nextPose = transformPose(nextPose, next, state);\n            var preTransition = nextPose.preTransition,\n                getTransition = nextPose.transition,\n                applyAtEnd = nextPose.applyAtEnd;\n            if (preTransition) preTransition(baseTransitionProps);\n            var animations = Object.keys(getPoseValues(nextPose)).map(function (key) {\n                var valuePoses = activePoses.has(key) ? activePoses.get(key) : (activePoses.set(key, []), activePoses.get(key));\n                var existingIndex = valuePoses.indexOf(next);\n                if (existingIndex !== -1) valuePoses.splice(existingIndex, 1);\n                var priority = posePriority ? posePriority.indexOf(next) : 0;\n                var insertionIndex = priority <= 0 ? 0 : findInsertionIndex(valuePoses, posePriority, priority);\n                valuePoses.splice(insertionIndex, 0, next);\n                return insertionIndex === 0 ? new Promise(function (complete) {\n                    var value = values.get(key);\n                    var transitionProps = __assign(__assign({}, baseTransitionProps), { key: key,\n                        value: value });\n                    var target = resolveTarget(value, resolveProp(nextPose[key], transitionProps));\n                    if (activeActions.has(key)) stopAction(activeActions.get(key));\n                    var resolveTransitionProps = __assign(__assign({ to: target }, transitionProps), getTransitionProps(value, target, transitionProps));\n                    var transition = resolveTransition(getTransition, key, value, resolveTransitionProps, convertTransitionDefinition, getInstantTransition);\n                    var poseDelay = delay || resolveProp(nextPose.delay, transitionProps);\n                    if (poseDelay) {\n                        transition = addActionDelay(poseDelay, transition);\n                    }\n                    activeActions.set(key, startAction(value, transition, complete));\n                }) : Promise.resolve();\n            });\n            return applyAtEnd ? [Promise.all(animations).then(function () {\n                applyValues(applyAtEnd, values, baseTransitionProps, setValue, setValueNative);\n            })] : animations;\n        };\n        if (nextPose && hasChildren) {\n            if (resolveProp(nextPose.beforeChildren, baseTransitionProps)) {\n                return Promise.all(getParentAnimations()).then(function () {\n                    return Promise.all(getChildAnimations());\n                });\n            } else if (resolveProp(nextPose.afterChildren, baseTransitionProps)) {\n                return Promise.all(getChildAnimations()).then(function () {\n                    return Promise.all(getParentAnimations());\n                });\n            }\n        }\n        return Promise.all(__spreadArrays(getParentAnimations(), getChildAnimations()));\n    };\n};\n\nvar DEFAULT_INITIAL_POSE = 'init';\nvar isScale = function (key) {\n    return key.includes('scale');\n};\nvar defaultReadValueFromSource = function (key) {\n    return isScale(key) ? 1 : 0;\n};\nvar readValueFromPose = function (pose, key, props) {\n    var valueToResolve = pose.applyAtEnd && pose.applyAtEnd[key] !== undefined ? pose.applyAtEnd[key] : pose[key] !== undefined ? pose[key] : pose.applyAtStart && pose.applyAtStart[key] !== undefined ? pose.applyAtStart[key] : 0;\n    return resolveProp(valueToResolve, props);\n};\nvar getPosesToSearch = function (pose) {\n    var posesToSearch = Array.isArray(pose) ? pose : [pose];\n    posesToSearch.push(DEFAULT_INITIAL_POSE);\n    return posesToSearch;\n};\nvar getInitialValue = function (poses, key, initialPose, props, readValueFromSource, activePoses) {\n    if (readValueFromSource === void 0) {\n        readValueFromSource = defaultReadValueFromSource;\n    }\n    var posesToSearch = getPosesToSearch(initialPose);\n    var pose = posesToSearch.filter(Boolean).find(function (name) {\n        var thisPose = poses[name];\n        return thisPose && (thisPose[key] !== undefined || thisPose.applyAtStart && thisPose.applyAtStart[key] !== undefined || thisPose.applyAtEnd && thisPose.applyAtEnd[key] !== undefined);\n    });\n    activePoses.set(key, [pose || DEFAULT_INITIAL_POSE]);\n    return pose ? readValueFromPose(poses[pose], key, props) : readValueFromSource(key, props);\n};\nvar createValues = function (values, _a) {\n    var userSetValues = _a.userSetValues,\n        createValue = _a.createValue,\n        convertValue = _a.convertValue,\n        readValueFromSource = _a.readValueFromSource,\n        initialPose = _a.initialPose,\n        poses = _a.poses,\n        activePoses = _a.activePoses,\n        props = _a.props;\n    return function (key) {\n        if (values.has(key)) return;\n        var value;\n        if (userSetValues && userSetValues[key] !== undefined) {\n            value = convertValue(userSetValues[key], key, props);\n        } else {\n            var initValue = getInitialValue(poses, key, initialPose, props, readValueFromSource, activePoses);\n            value = createValue(initValue, key, props);\n        }\n        values.set(key, value);\n    };\n};\nvar scrapeValuesFromPose = function (values, props) {\n    return function (key) {\n        var pose = props.poses[key];\n        Object.keys(getPoseValues(pose)).forEach(createValues(values, props));\n    };\n};\nvar getAncestorValue = function (key, fromParent, ancestors) {\n    if (fromParent === true) {\n        return ancestors[0] && ancestors[0].values.get(key);\n    } else {\n        var foundAncestor = ancestors.find(function (_a) {\n            var label = _a.label;\n            return label === fromParent;\n        });\n        return foundAncestor && foundAncestor.values.get(key);\n    }\n};\nvar bindPassiveValues = function (values, _a) {\n    var passive = _a.passive,\n        ancestorValues = _a.ancestorValues,\n        createValue = _a.createValue,\n        readValue = _a.readValue,\n        props = _a.props;\n    return function (key) {\n        var _a = passive[key],\n            valueKey = _a[0],\n            passiveProps = _a[1],\n            fromParent = _a[2];\n        var valueToBind = fromParent && ancestorValues.length ? getAncestorValue(valueKey, fromParent, ancestorValues) : values.has(valueKey) ? values.get(valueKey) : false;\n        if (!valueToBind) return;\n        var newValue = createValue(readValue(valueToBind), key, props, {\n            passiveParentKey: valueKey,\n            passiveParent: valueToBind,\n            passiveProps: passiveProps\n        });\n        values.set(key, newValue);\n    };\n};\nvar setNativeValues = function (_a) {\n    var setValueNative = _a.setValueNative,\n        initialPose = _a.initialPose,\n        props = _a.props,\n        poses = _a.poses;\n    var valuesHaveSet = new Set();\n    var setValues = function (pose, propKey) {\n        if (pose[propKey]) {\n            for (var key in pose[propKey]) {\n                if (!valuesHaveSet.has(key)) {\n                    valuesHaveSet.add(key);\n                    setValueNative(key, resolveProp(pose[propKey][key], props), props);\n                }\n            }\n        }\n    };\n    getPosesToSearch(initialPose).forEach(function (poseKey) {\n        var pose = poses[poseKey];\n        if (pose) {\n            setValues(pose, 'applyAtEnd');\n            setValues(pose, 'applyAtStart');\n        }\n    });\n};\nvar createValueMap = function (props) {\n    var poses = props.poses,\n        passive = props.passive;\n    var values = new Map();\n    Object.keys(poses).forEach(scrapeValuesFromPose(values, props));\n    setNativeValues(props);\n    if (passive) Object.keys(passive).forEach(bindPassiveValues(values, props));\n    return values;\n};\n\nvar applyDefaultTransition = function (pose, key, defaultTransitions) {\n    return __assign(__assign({}, pose), { transition: defaultTransitions.has(key) ? defaultTransitions.get(key) : defaultTransitions.get('default') });\n};\nvar generateTransitions = function (poses, defaultTransitions) {\n    Object.keys(poses).forEach(function (key) {\n        var pose = poses[key];\n        invariant(typeof pose === 'object', \"Pose '\" + key + \"' is of invalid type. All poses should be objects.\");\n        poses[key] = pose.transition !== undefined ? pose : applyDefaultTransition(pose, key, defaultTransitions);\n    });\n    return poses;\n};\n\nvar sortByReversePriority = function (priorityOrder) {\n    return function (a, b) {\n        var aP = priorityOrder.indexOf(a);\n        var bP = priorityOrder.indexOf(b);\n        if (aP === -1 && bP !== -1) return -1;\n        if (aP !== -1 && bP === -1) return 1;\n        return aP - bP;\n    };\n};\n\nvar poseFactory = function (_a) {\n    var getDefaultProps = _a.getDefaultProps,\n        defaultTransitions = _a.defaultTransitions,\n        bindOnChange = _a.bindOnChange,\n        startAction = _a.startAction,\n        stopAction = _a.stopAction,\n        readValue = _a.readValue,\n        readValueFromSource = _a.readValueFromSource,\n        resolveTarget = _a.resolveTarget,\n        setValue = _a.setValue,\n        setValueNative = _a.setValueNative,\n        createValue = _a.createValue,\n        convertValue = _a.convertValue,\n        getInstantTransition = _a.getInstantTransition,\n        getTransitionProps = _a.getTransitionProps,\n        addActionDelay = _a.addActionDelay,\n        selectValueToRead = _a.selectValueToRead,\n        convertTransitionDefinition = _a.convertTransitionDefinition,\n        transformPose = _a.transformPose,\n        posePriority = _a.posePriority,\n        forceRender = _a.forceRender,\n        extendAPI = _a.extendAPI;\n    return function (config) {\n        var parentValues = config.parentValues,\n            _a = config.ancestorValues,\n            ancestorValues = _a === void 0 ? [] : _a;\n        if (parentValues) ancestorValues.unshift({ values: parentValues });\n        var activeActions = new Map();\n        var activePoses = new Map();\n        var children = new Set();\n        var poses = generateTransitions(selectPoses(config), defaultTransitions);\n        var _b = config.props,\n            props = _b === void 0 ? {} : _b;\n        if (getDefaultProps) props = __assign(__assign({}, getDefaultProps(config)), props);\n        var passive = config.passive,\n            userSetValues = config.values,\n            _c = config.initialPose,\n            initialPose = _c === void 0 ? DEFAULT_INITIAL_POSE : _c;\n        var values = createValueMap({\n            poses: poses,\n            passive: passive,\n            ancestorValues: ancestorValues,\n            readValue: readValue,\n            setValueNative: setValueNative,\n            createValue: createValue,\n            convertValue: convertValue,\n            readValueFromSource: readValueFromSource,\n            userSetValues: userSetValues,\n            initialPose: initialPose,\n            activePoses: activePoses,\n            props: props\n        });\n        var state = {\n            activeActions: activeActions,\n            activePoses: activePoses,\n            children: children,\n            props: props,\n            values: values\n        };\n        var onChange = config.onChange;\n        if (onChange) Object.keys(onChange).forEach(bindOnChange(values, onChange));\n        var set = createPoseSetter({\n            state: state,\n            poses: poses,\n            getInstantTransition: getInstantTransition,\n            getTransitionProps: getTransitionProps,\n            convertTransitionDefinition: convertTransitionDefinition,\n            setValue: setValue,\n            setValueNative: setValueNative,\n            startAction: startAction,\n            stopAction: stopAction,\n            resolveTarget: resolveTarget,\n            addActionDelay: addActionDelay,\n            transformPose: transformPose,\n            posePriority: posePriority,\n            forceRender: forceRender\n        });\n        var has = function (poseName) {\n            return !!poses[poseName];\n        };\n        var api = {\n            set: set,\n            unset: function (poseName, poseProps) {\n                var posesToSet = [];\n                activePoses.forEach(function (valuePoses) {\n                    var poseIndex = valuePoses.indexOf(poseName);\n                    if (poseIndex === -1) return;\n                    var currentPose = valuePoses[0];\n                    valuePoses.splice(poseIndex, 1);\n                    var nextPose = valuePoses[0];\n                    if (nextPose === currentPose) return;\n                    if (posesToSet.indexOf(nextPose) === -1) {\n                        posesToSet.push(nextPose);\n                    }\n                });\n                var animationsToResolve = posesToSet.sort(sortByReversePriority(posePriority)).map(function (poseToSet) {\n                    return set(poseToSet, poseProps, false);\n                });\n                children.forEach(function (child) {\n                    return animationsToResolve.push(child.unset(poseName));\n                });\n                return Promise.all(animationsToResolve);\n            },\n            get: function (valueName) {\n                return valueName ? selectValueToRead(values.get(valueName)) : selectAllValues(values, selectValueToRead);\n            },\n            has: has,\n            setProps: function (newProps) {\n                return state.props = __assign(__assign({}, state.props), newProps);\n            },\n            _addChild: function (childConfig, factory) {\n                var child = factory(__assign(__assign({ initialPose: initialPose }, childConfig), { ancestorValues: __spreadArrays([{ label: config.label, values: values }], ancestorValues) }));\n                children.add(child);\n                return child;\n            },\n            removeChild: function (child) {\n                return children.delete(child);\n            },\n            clearChildren: function () {\n                children.forEach(function (child) {\n                    return child.destroy();\n                });\n                children.clear();\n            },\n            destroy: function () {\n                activeActions.forEach(stopAction);\n                children.forEach(function (child) {\n                    return child.destroy();\n                });\n            }\n        };\n        return extendAPI(api, state, config);\n    };\n};\n\nexport default poseFactory;\n"]},"metadata":{},"sourceType":"module"}